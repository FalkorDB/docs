<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li:not(:nth-child(15)) > a, .site-nav > ul.nav-list:first-child > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(15) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(15) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(15) > ul.nav-list { display: block; } </style> <script async src="https://www.googletagmanager.com/gtag/js?id=G-0V4CX90653"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-0V4CX90653'); </script> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/images/favicon.ico" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>The FalkorDB Design | FalkorDB Docs</title> <meta name="generator" content="Jekyll v3.10.0" /> <meta property="og:title" content="The FalkorDB Design" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="FalkorDB: A High Performance In-Memory Graph Database" /> <meta property="og:description" content="FalkorDB: A High Performance In-Memory Graph Database" /> <link rel="canonical" href="https://docs.falkordb.com/design/" /> <meta property="og:url" content="https://docs.falkordb.com/design/" /> <meta property="og:site_name" content="FalkorDB Docs" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="The FalkorDB Design" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"FalkorDB: A High Performance In-Memory Graph Database","headline":"The FalkorDB Design","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://docs.falkordb.com/images/falkor-logo.png"}},"url":"https://docs.falkordb.com/design/"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> <div class="site-logo" role="img" aria-label="FalkorDB Docs"></div> </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/configuration.html" class="nav-list-link">Configuration Parameters</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Commands category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/commands/" class="nav-list-link">Commands</a><ul class="nav-list"><li class="nav-list-item"><a href="/commands/graph.query.html" class="nav-list-link">GRAPH.QUERY</a></li><li class="nav-list-item"><a href="/commands/graph.ro_query.html" class="nav-list-link">GRAPH.RO_QUERY</a></li><li class="nav-list-item"><a href="/commands/graph.delete.html" class="nav-list-link">GRAPH.DELETE</a></li><li class="nav-list-item"><a href="/commands/graph.explain.html" class="nav-list-link">GRAPH.EXPLAIN</a></li><li class="nav-list-item"><a href="/commands/graph.list.html" class="nav-list-link">GRAPH.LIST</a></li><li class="nav-list-item"><a href="/commands/graph.profile.html" class="nav-list-link">GRAPH.PROFILE</a></li><li class="nav-list-item"><a href="/commands/graph.config-get.html" class="nav-list-link">GRAPH.CONFIG-GET</a></li><li class="nav-list-item"><a href="/commands/graph.config-set.html" class="nav-list-link">GRAPH.CONFIG-SET</a></li><li class="nav-list-item"><a href="/commands/graph.constraint-create.html" class="nav-list-link">GRAPH.CONSTRAINT CREATE</a></li><li class="nav-list-item"><a href="/commands/graph.constraint-drop.html" class="nav-list-link">GRAPH.CONSTRAINT DROP</a></li><li class="nav-list-item"><a href="/commands/graph.copy.html" class="nav-list-link">GRAPH.COPY</a></li><li class="nav-list-item"><a href="/commands/graph.info.html" class="nav-list-link">GRAPH.INFO</a></li><li class="nav-list-item"><a href="/commands/graph.slowlog.html" class="nav-list-link">GRAPH.SLOWLOG</a></li></ul></li><li class="nav-list-item"><a href="/clients.html" class="nav-list-link">Client Libraries</a></li><li class="nav-list-item"><a href="/datatypes.html" class="nav-list-link">Data types</a></li><li class="nav-list-item"><a href="/path_algorithm.html" class="nav-list-link">Path algorithms</a></li><li class="nav-list-item"><a href="/docker-examples/README.html" class="nav-list-link">Building Docker</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Cypher Language category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/cypher/" class="nav-list-link">Cypher Language</a><ul class="nav-list"><li class="nav-list-item"><a href="/cypher/match.html" class="nav-list-link">MATCH</a></li><li class="nav-list-item"><a href="/cypher/optional_match.html" class="nav-list-link">OPTIONAL MATCH</a></li><li class="nav-list-item"><a href="/cypher/where.html" class="nav-list-link">WHERE</a></li><li class="nav-list-item"><a href="/cypher/return.html" class="nav-list-link">RETURN</a></li><li class="nav-list-item"><a href="/cypher/order_by.html" class="nav-list-link">ORDER BY</a></li><li class="nav-list-item"><a href="/cypher/skip.html" class="nav-list-link">SKIP</a></li><li class="nav-list-item"><a href="/cypher/limit.html" class="nav-list-link">LIMIT</a></li><li class="nav-list-item"><a href="/cypher/create.html" class="nav-list-link">CREATE</a></li><li class="nav-list-item"><a href="/cypher/delete.html" class="nav-list-link">DELETE</a></li><li class="nav-list-item"><a href="/cypher/set.html" class="nav-list-link">SET</a></li><li class="nav-list-item"><a href="/cypher/merge.html" class="nav-list-link">MERGE</a></li><li class="nav-list-item"><a href="/cypher/with.html" class="nav-list-link">WITH</a></li><li class="nav-list-item"><a href="/cypher/union.html" class="nav-list-link">UNION</a></li><li class="nav-list-item"><a href="/cypher/unwind.html" class="nav-list-link">UNWIND</a></li><li class="nav-list-item"><a href="/cypher/foreach.html" class="nav-list-link">FOREACH</a></li><li class="nav-list-item"><a href="/cypher/call.html" class="nav-list-link">CALL</a></li><li class="nav-list-item"><a href="/cypher/functions.html" class="nav-list-link">Functions</a></li><li class="nav-list-item"><a href="/cypher/procedures.html" class="nav-list-link">Procedures</a></li><li class="nav-list-item"><a href="/cypher/algorithms.html" class="nav-list-link">Algorithms</a></li><li class="nav-list-item"><a href="/cypher/indexing.html" class="nav-list-link">Indexing</a></li><li class="nav-list-item"><a href="/cypher/cypher_support.html" class="nav-list-link">Cypher coverage</a></li><li class="nav-list-item"><a href="/cypher/known_limitations.html" class="nav-list-link">Known limitations</a></li></ul></li><li class="nav-list-item"><a href="/llm_support.html" class="nav-list-link">LLM frameworks support</a></li><li class="nav-list-item"><a href="/bolt_support.html" class="nav-list-link">BOLT protocol support</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Operations category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/operations/" class="nav-list-link">Operations</a><ul class="nav-list"><li class="nav-list-item"><a href="/operations/persistence.html" class="nav-list-link">Persistence</a></li><li class="nav-list-item"><a href="/operations/replication.html" class="nav-list-link">Replication</a></li><li class="nav-list-item"><a href="/operations/cluster.html" class="nav-list-link">Cluster</a></li><li class="nav-list-item"><a href="/operations/k8s_support.html" class="nav-list-link">Kubernetes support</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Management category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/management/" class="nav-list-link">Management</a><ul class="nav-list"><li class="nav-list-item"><a href="/management/persistence.html" class="nav-list-link">Persistence</a></li></ul></li><li class="nav-list-item"><a href="/redisgraph-to-falkordb.html" class="nav-list-link">RedisGraph to FalkorDB</a></li><li class="nav-list-item"><a href="/References.html" class="nav-list-link">References</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in The FalkorDB Design category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/design/" class="nav-list-link">The FalkorDB Design</a><ul class="nav-list"><li class="nav-list-item"><a href="/design/client_spec.html" class="nav-list-link">Client Specification</a></li><li class="nav-list-item"><a href="/design/bulk_spec.html" class="nav-list-link">GRAPH.BULK endpoint specification</a></li><li class="nav-list-item"><a href="/design/result_structure.html" class="nav-list-link">Result Set Structure</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search FalkorDB Docs" aria-label="Search FalkorDB Docs" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/falkordb/docs" class="site-button" target="_blank" rel="noopener noreferrer" > Docs Repository </a> </li> <li class="aux-nav-list-item"> <a href="//github.com/falkordb/falkordb" class="site-button" target="_blank" rel="noopener noreferrer" > FalkorDB Repository </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <div id="main-content" class="main-content"> <main> <h1 id="the-falkordb-design"> <a href="#the-falkordb-design" class="anchor-heading" aria-labelledby="the-falkordb-design"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The FalkorDB Design </h1> <h2 id="abstract"> <a href="#abstract" class="anchor-heading" aria-labelledby="abstract"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Abstract </h2> <p>Graph-based data is everywhere nowadays. Facebook, Google, Twitter and Pinterest are just a few who’ve realize the power behind relationship data and are utilizing it to its fullest. As a direct result, we see a rise both in interest for and the variety of graph data solutions.</p> <p>With the introduction of <a href="http://antirez.com/news/106">Redis Modules</a> we’ve recognized the great potential of introducing a graph data structure to the Redis arsenal, and developed FalkorDB. Bringing new graph capabilities to Redis through a native C implementation with an emphasis on performance, <a href="https://github.com/FalkorDB/FalkorDB">FalkorDB</a> is now available as an open source project.</p> <p>In this documentation, we’ll discuss the internal design and features of FalkorDB and demonstrate its current capabilities.</p> <h2 id="falkordb-at-a-glance"> <a href="#falkordb-at-a-glance" class="anchor-heading" aria-labelledby="falkordb-at-a-glance"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> FalkorDB At-a-Glance </h2> <p>FalkorDB is a graph database developed from scratch on top of Redis, using the new Redis Modules API to extend Redis with new commands and capabilities. Its main features include:</p> <ul> <li>Simple, fast indexing and querying</li> <li>Data stored in RAM using memory-efficient custom data structures</li> <li>On-disk persistence</li> <li>Tabular result sets</li> <li>Uses the popular graph query language <a href="https://opencypher.org/">openCypher</a></li> </ul> <h2 id="a-little-taste-falkordb-in-action"> <a href="#a-little-taste-falkordb-in-action" class="anchor-heading" aria-labelledby="a-little-taste-falkordb-in-action"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> A Little Taste: FalkorDB in Action </h2> <p>Let’s look at some of the key concepts of FalkorDB using this example over the redis-cli tool:</p> <h3 id="constructing-a-graph"> <a href="#constructing-a-graph" class="anchor-heading" aria-labelledby="constructing-a-graph"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Constructing a graph </h3> <p>It is common to represent entities as nodes within a graph. In this example, we’ll create a small graph with both actors and movies as its entities, and an “act” relation that will connect actors to the movies they acted in. We’ll use the graph.QUERY command to issue a CREATE query, which will introduce new entities and relations to our graph.</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>graph.QUERY &lt;graph_id&gt; <span class="s1">'CREATE (:&lt;label&gt; {&lt;attribute_name&gt;:&lt;attribute_value&gt;,...})'</span>
</code></pre></div></div> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>graph.QUERY &lt;graph_id&gt; <span class="s1">'CREATE (&lt;source_node_alias&gt;)-[&lt;relation&gt; {&lt;attribute_name&gt;:&lt;attribute_value&gt;,...}]-&gt;(&lt;dest_node_alias&gt;)'</span>
</code></pre></div></div> <p>We’ll construct our graph in one command:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>graph.QUERY IMDB <span class="s1">'CREATE (aldis:actor {name: "Aldis Hodge", birth_year: 1986}),
                         (oshea:actor {name: "OShea Jackson", birth_year: 1991}),
                         (corey:actor {name: "Corey Hawkins", birth_year: 1988}),
                         (neil:actor {name: "Neil Brown", birth_year: 1980}),
                         (compton:movie {title: "Straight Outta Compton", genre: "Biography", votes: 127258, rating: 7.9, year: 2015}),
                         (neveregoback:movie {title: "Never Go Back", genre: "Action", votes: 15821, rating: 6.4, year: 2016}),
                         (aldis)-[:act]-&gt;(neveregoback),
                         (aldis)-[:act]-&gt;(compton),
                         (oshea)-[:act]-&gt;(compton),
                         (corey)-[:act]-&gt;(compton),
                         (neil)-[:act]-&gt;(compton)'</span>
</code></pre></div></div> <h3 id="querying-the-graph"> <a href="#querying-the-graph" class="anchor-heading" aria-labelledby="querying-the-graph"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Querying the graph </h3> <p>FalkorDB exposes a subset of the openCypher graph language. Although only some language capabilities are supported, there’s enough functionality to extract valuable insights from your graphs. To execute a query, we’ll use the GRAPH.QUERY command:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GRAPH.QUERY &lt;graph_id&gt; &lt;query&gt;
</code></pre></div></div> <p>Let’s execute a number of queries against our movies graph.</p> <p>Find the sum, max, min and avg age of the ‘Straight Outta Compton’ cast:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GRAPH.QUERY IMDB <span class="s1">'MATCH (a:actor)-[:act]-&gt;(m:movie {title:"Straight Outta Compton"})
RETURN m.title, SUM(2020-a.birth_year), MAX(2020-a.birth_year), MIN(2020-a.birth_year), AVG(2020-a.birth_year)'</span>
</code></pre></div></div> <p>FalkorDB will reply with:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"m.title"</span>
   2<span class="o">)</span> <span class="s2">"SUM(2020-a.birth_year)"</span>
   3<span class="o">)</span> <span class="s2">"MAX(2020-a.birth_year)"</span>
   4<span class="o">)</span> <span class="s2">"MIN(2020-a.birth_year)"</span>
   5<span class="o">)</span> <span class="s2">"AVG(2020-a.birth_year)"</span>
2<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"Straight Outta Compton"</span>
      2<span class="o">)</span> <span class="s2">"135"</span>
      3<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 40
      4<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 29
      5<span class="o">)</span> <span class="s2">"33.75"</span>
</code></pre></div></div> <ul> <li>The first row is our result-set header which names each column according to the return clause.</li> <li>The second row contains our query result.</li> </ul> <p>Let’s try another query. This time, we’ll find out how many movies each actor played in.</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GRAPH.QUERY IMDB <span class="s2">"MATCH (actor)-[:act]-&gt;(movie) RETURN actor.name, COUNT(movie.title) AS movies_count ORDER BY
movies_count DESC"</span>

1<span class="o">)</span> <span class="s2">"actor.name, movies_count"</span>
2<span class="o">)</span> <span class="s2">"Aldis Hodge,2.000000"</span>
3<span class="o">)</span> <span class="s2">"O'Shea Jackson,1.000000"</span>
4<span class="o">)</span> <span class="s2">"Corey Hawkins,1.000000"</span>
5<span class="o">)</span> <span class="s2">"Neil Brown,1.000000"</span>
</code></pre></div></div> <h2 id="the-theory-ideas-behind-falkordb"> <a href="#the-theory-ideas-behind-falkordb" class="anchor-heading" aria-labelledby="the-theory-ideas-behind-falkordb"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> The Theory: Ideas behind FalkorDB </h2> <h3 id="representation"> <a href="#representation" class="anchor-heading" aria-labelledby="representation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Representation </h3> <p>FalkorDB uses sparse adjacency matrices to represent graphs. As directed relationship connecting source node S to destination node T is recorded within an adjacency matrix M, by setting M’s S,T entry to 1 (M[S,T]=1). As a rule of thumb, matrix rows represent source nodes while matrix columns represent destination nodes.</p> <p>Every graph stored within FalkorDB has at least one matrix, referred to as THE adjacency matrix (relation-type agnostic). In addition, every relation with a type has its own dedicated matrix. Consider a graph with two relationships types:</p> <ol> <li>visits</li> <li>friend</li> </ol> <p>The underlying graph data structure maintains three matrices:</p> <ol> <li>THE adjacency matrix - marking every connection within the graph</li> <li>visit matrix - marking visit connections</li> <li>friend matrix - marking friend connections</li> </ol> <p>A ‘visit’ relationship E that connects node A to node B, sets THE adjacency matrix at position [A,B] to 1. Also, the visit matrix V sets position V[A,B] to the corresponding relationship-id.</p> <p>To accommodate typed nodes, one additional matrix is allocated per label, and a label matrix is symmetric with ones along the main diagonal. Assume that node N was labeled as a Person, then the Person matrix P sets position P[N,N] to 1.</p> <p>This design lets FalkorDB modify its graph easily, including:</p> <ul> <li>Adding new nodes simply extends matrices, adding additional rows and columns</li> <li>Adding new relationships by setting the relevant entries at the relevant matrices</li> <li>Removing relationships clears relevant entries</li> <li>Deleting nodes by deleting matrix row/column.</li> </ul> <p>One of the main reasons we chose to represent our graphs as sparse matrices is graph traversal.</p> <h3 id="traversal"> <a href="#traversal" class="anchor-heading" aria-labelledby="traversal"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Traversal </h3> <p>Graph traversal is done by matrix multiplication. For example, if we wanted to find friends of friends for every node in the graph, this traversal can be expressed by FOF = F^2. F stands for the friendship relation matrix, and the result matrix FOF summarizes the traversal. The rows of the FOF represent source nodes and its columns represent friends who are two hops away: if FOF[i,j] = 1 then j is a friend of a friend of i.</p> <h3 id="algebraic-expression"> <a href="#algebraic-expression" class="anchor-heading" aria-labelledby="algebraic-expression"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Algebraic expression </h3> <p>When a search pattern such as <code class="language-plaintext highlighter-rouge">(N0)-[A]-&gt;(N1)-[B]-&gt;(N2)&lt;-[A]-(N3)</code> is used as part of a query, we translate it into a set of matrix multiplications. For the given example, one possible expression would be: <code class="language-plaintext highlighter-rouge">A * B * Transpose(A)</code>.</p> <p>Note that matrix multiplication is an associative and distributive operation. This gives us the freedom to choose which terms we want to multiply first (preferring terms that will produce highly sparse intermediate matrices). It also enables concurrency when evaluating an expression, e.g. we could compute A<em>Z and B</em>Y in parallel.</p> <h3 id="graphblas"> <a href="#graphblas" class="anchor-heading" aria-labelledby="graphblas"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> GraphBLAS </h3> <p>To perform all of these operations for sparse matrices, FalkorDB uses <a href="http://graphblas.org/">GraphBLAS</a> - a standard API similar to BLAS. The current implementation uses the CSC sparse matrix format (compressed sparse columns), although the underlying format is subject to change.</p> <h2 id="query-language-opencypher"> <a href="#query-language-opencypher" class="anchor-heading" aria-labelledby="query-language-opencypher"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Query language: openCypher </h2> <p>There are a number of graph query languages, so we didn’t want to reinvent the wheel. We decided to implement a subset of one of the most popular graph query languages out there: openCypher While the openCypher project provides a parser for the language, we decided to create our own parser. We used Lex as a tokenizer and Lemon to generate a C target parser.</p> <p>As mentioned earlier, only a subset of the language is currently supported, but we plan to continue adding new capabilities and extend FalkorDB’s openCypher capabilities.</p> <h2 id="runtime-query-execution"> <a href="#runtime-query-execution" class="anchor-heading" aria-labelledby="runtime-query-execution"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Runtime: query execution </h2> <p>Let’s review the steps FalkorDB takes when executing a query.</p> <p>Consider this query that finds all actors who played alongside Aldis Hodge and are over 30 years old:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MATCH <span class="o">(</span>aldis::actor <span class="o">{</span>name:<span class="s2">"Aldis Hodge"</span><span class="o">})</span>-[:act]-&gt;<span class="o">(</span>m:movie<span class="o">)</span>&lt;-[:act]-<span class="o">(</span>a:actor<span class="o">)</span> WHERE a.age <span class="o">&gt;</span> 30 RETURN m.title, a.name
</code></pre></div></div> <p>FalkorDB will:</p> <ul> <li>Parse the query, and build an abstract syntax tree (AST)</li> <li>Compose traversal algebraic expressions</li> <li>Build filter trees</li> <li>Construct an optimized query execution plan composed of: <ul> <li>Filtered traverse</li> <li>Conditional traverse</li> <li>Filter</li> <li>Project</li> </ul> </li> <li>Execute the plan</li> <li>Populate a result set with matching entity attributes</li> </ul> <h3 id="filter-tree"> <a href="#filter-tree" class="anchor-heading" aria-labelledby="filter-tree"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Filter tree </h3> <p>A query can filter out entities by creating predicates. In our example, we filter actors younger then 30.</p> <p>It’s possible to combine predicates using OR and AND keywords to form granular conditions.</p> <p>During runtime, the WHERE clause is used to construct a filter tree, and each node within the tree is either a condition (e.g. A &gt; B) or an operation (AND/OR). When finding candidate entities, they are passed through the tree and evaluated.</p> <h2 id="benchmarks"> <a href="#benchmarks" class="anchor-heading" aria-labelledby="benchmarks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Benchmarks </h2> <p>Depending on the underlying hardware results may vary. However, inserting a new relationship is done in O(1). FalkorDB is able to create over 1 million nodes under half a second and form 500K relations within 0.3 of a second.</p> <h2 id="license"> <a href="#license" class="anchor-heading" aria-labelledby="license"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> License </h2> <p>FalkorDB is published under the <a href="https://redis.com/legal/licenses/">Server Side Public License v1 (SSPLv1)</a>.</p> <h2 id="conclusion"> <a href="#conclusion" class="anchor-heading" aria-labelledby="conclusion"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Conclusion </h2> <p>Although FalkorDB is still a young project, it can be an alternative to other graph databases. With its subset of operations, you can use it to analyze and explore graph data. Being a Redis Module, this project is accessible from every Redis client without adjustments. It’s our intention to keep on improving and extending FalkorDB with the help of the open source community.</p> <hr> <h2 class="text-delta">Table of contents</h2> <ul> <li> <a href="/design/client_spec.html">Client Specification</a> </li> <li> <a href="/design/bulk_spec.html">GRAPH.BULK endpoint specification</a> </li> <li> <a href="/design/result_structure.html">Result Set Structure</a> </li> </ul> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
