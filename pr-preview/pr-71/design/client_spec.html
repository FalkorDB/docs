<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(1)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(15) > ul > li:nth-child(1) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(15) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(15) > ul > li:nth-child(1) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(15) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(15) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list { display: block; } </style> <script async src="https://www.googletagmanager.com/gtag/js?id=G-0V4CX90653"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-0V4CX90653'); </script> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="icon" href="/images/favicon.ico" type="image/x-icon"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Client Specification | FalkorDB Docs</title> <meta name="generator" content="Jekyll v3.10.0" /> <meta property="og:title" content="Client Specification" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Technical specification for writing FalkorDB client libraries" /> <meta property="og:description" content="Technical specification for writing FalkorDB client libraries" /> <link rel="canonical" href="https://docs.falkordb.com/design/client_spec.html" /> <meta property="og:url" content="https://docs.falkordb.com/design/client_spec.html" /> <meta property="og:site_name" content="FalkorDB Docs" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Client Specification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Technical specification for writing FalkorDB client libraries","headline":"Client Specification","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://docs.falkordb.com/images/falkor-logo.png"}},"url":"https://docs.falkordb.com/design/client_spec.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> <div class="site-logo" role="img" aria-label="FalkorDB Docs"></div> </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="/configuration.html" class="nav-list-link">Configuration Parameters</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Commands category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/commands/" class="nav-list-link">Commands</a><ul class="nav-list"><li class="nav-list-item"><a href="/commands/graph.query.html" class="nav-list-link">GRAPH.QUERY</a></li><li class="nav-list-item"><a href="/commands/graph.ro_query.html" class="nav-list-link">GRAPH.RO_QUERY</a></li><li class="nav-list-item"><a href="/commands/graph.delete.html" class="nav-list-link">GRAPH.DELETE</a></li><li class="nav-list-item"><a href="/commands/graph.explain.html" class="nav-list-link">GRAPH.EXPLAIN</a></li><li class="nav-list-item"><a href="/commands/graph.list.html" class="nav-list-link">GRAPH.LIST</a></li><li class="nav-list-item"><a href="/commands/graph.profile.html" class="nav-list-link">GRAPH.PROFILE</a></li><li class="nav-list-item"><a href="/commands/graph.config-get.html" class="nav-list-link">GRAPH.CONFIG-GET</a></li><li class="nav-list-item"><a href="/commands/graph.config-set.html" class="nav-list-link">GRAPH.CONFIG-SET</a></li><li class="nav-list-item"><a href="/commands/graph.constraint-create.html" class="nav-list-link">GRAPH.CONSTRAINT CREATE</a></li><li class="nav-list-item"><a href="/commands/graph.constraint-drop.html" class="nav-list-link">GRAPH.CONSTRAINT DROP</a></li><li class="nav-list-item"><a href="/commands/graph.copy.html" class="nav-list-link">GRAPH.COPY</a></li><li class="nav-list-item"><a href="/commands/graph.info.html" class="nav-list-link">GRAPH.INFO</a></li><li class="nav-list-item"><a href="/commands/graph.slowlog.html" class="nav-list-link">GRAPH.SLOWLOG</a></li></ul></li><li class="nav-list-item"><a href="/clients.html" class="nav-list-link">Client Libraries</a></li><li class="nav-list-item"><a href="/datatypes.html" class="nav-list-link">Data types</a></li><li class="nav-list-item"><a href="/path_algorithm.html" class="nav-list-link">Path algorithms</a></li><li class="nav-list-item"><a href="/docker-examples/README.html" class="nav-list-link">Building Docker</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Cypher Language category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/cypher/" class="nav-list-link">Cypher Language</a><ul class="nav-list"><li class="nav-list-item"><a href="/cypher/match.html" class="nav-list-link">MATCH</a></li><li class="nav-list-item"><a href="/cypher/optional_match.html" class="nav-list-link">OPTIONAL MATCH</a></li><li class="nav-list-item"><a href="/cypher/where.html" class="nav-list-link">WHERE</a></li><li class="nav-list-item"><a href="/cypher/return.html" class="nav-list-link">RETURN</a></li><li class="nav-list-item"><a href="/cypher/order_by.html" class="nav-list-link">ORDER BY</a></li><li class="nav-list-item"><a href="/cypher/skip.html" class="nav-list-link">SKIP</a></li><li class="nav-list-item"><a href="/cypher/limit.html" class="nav-list-link">LIMIT</a></li><li class="nav-list-item"><a href="/cypher/create.html" class="nav-list-link">CREATE</a></li><li class="nav-list-item"><a href="/cypher/delete.html" class="nav-list-link">DELETE</a></li><li class="nav-list-item"><a href="/cypher/set.html" class="nav-list-link">SET</a></li><li class="nav-list-item"><a href="/cypher/merge.html" class="nav-list-link">MERGE</a></li><li class="nav-list-item"><a href="/cypher/with.html" class="nav-list-link">WITH</a></li><li class="nav-list-item"><a href="/cypher/union.html" class="nav-list-link">UNION</a></li><li class="nav-list-item"><a href="/cypher/unwind.html" class="nav-list-link">UNWIND</a></li><li class="nav-list-item"><a href="/cypher/foreach.html" class="nav-list-link">FOREACH</a></li><li class="nav-list-item"><a href="/cypher/call.html" class="nav-list-link">CALL</a></li><li class="nav-list-item"><a href="/cypher/functions.html" class="nav-list-link">Functions</a></li><li class="nav-list-item"><a href="/cypher/procedures.html" class="nav-list-link">Procedures</a></li><li class="nav-list-item"><a href="/cypher/algorithms.html" class="nav-list-link">Algorithms</a></li><li class="nav-list-item"><a href="/cypher/indexing.html" class="nav-list-link">Indexing</a></li><li class="nav-list-item"><a href="/cypher/cypher_support.html" class="nav-list-link">Cypher coverage</a></li><li class="nav-list-item"><a href="/cypher/known_limitations.html" class="nav-list-link">Known limitations</a></li></ul></li><li class="nav-list-item"><a href="/llm_support.html" class="nav-list-link">LLM frameworks support</a></li><li class="nav-list-item"><a href="/bolt_support.html" class="nav-list-link">BOLT protocol support</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Operations category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/operations/" class="nav-list-link">Operations</a><ul class="nav-list"><li class="nav-list-item"><a href="/operations/persistence.html" class="nav-list-link">Persistence</a></li><li class="nav-list-item"><a href="/operations/replication.html" class="nav-list-link">Replication</a></li><li class="nav-list-item"><a href="/operations/cluster.html" class="nav-list-link">Cluster</a></li><li class="nav-list-item"><a href="/operations/k8s_support.html" class="nav-list-link">Kubernetes support</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Management category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/management/" class="nav-list-link">Management</a><ul class="nav-list"><li class="nav-list-item"><a href="/management/persistence.html" class="nav-list-link">Persistence</a></li></ul></li><li class="nav-list-item"><a href="/redisgraph-to-falkordb.html" class="nav-list-link">RedisGraph to FalkorDB</a></li><li class="nav-list-item"><a href="/References.html" class="nav-list-link">References</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in The FalkorDB Design category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/design/" class="nav-list-link">The FalkorDB Design</a><ul class="nav-list"><li class="nav-list-item"><a href="/design/client_spec.html" class="nav-list-link">Client Specification</a></li><li class="nav-list-item"><a href="/design/bulk_spec.html" class="nav-list-link">GRAPH.BULK endpoint specification</a></li><li class="nav-list-item"><a href="/design/result_structure.html" class="nav-list-link">Result Set Structure</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search FalkorDB Docs" aria-label="Search FalkorDB Docs" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/falkordb/docs" class="site-button" target="_blank" rel="noopener noreferrer" > Docs Repository </a> </li> <li class="aux-nav-list-item"> <a href="//github.com/falkordb/falkordb" class="site-button" target="_blank" rel="noopener noreferrer" > FalkorDB Repository </a> </li> </ul> </nav> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/design/">The FalkorDB Design</a></li> <li class="breadcrumb-nav-list-item"><span>Client Specification</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="client-specification"> <a href="#client-specification" class="anchor-heading" aria-labelledby="client-specification"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Client Specification </h1> <p>By design, there is not a full standard for FalkorDB clients to adhere to. Areas such as pretty-print formatting, query validation, and transactional and multithreaded capabilities have no canonically correct behavior, and the implementer is free to choose the approach and complexity that suits them best.</p> <p>FalkorDB does, however, provide a compact result set format for clients that minimizes the amount of redundant data transmitted from the server. Implementers are encouraged to take advantage of this format, as it provides better performance and removes ambiguity from decoding certain data. This approach requires clients to be capable of issuing procedure calls to the server and performing a small amount of client-side caching.</p> <h2 id="retrieving-the-compact-result-set"> <a href="#retrieving-the-compact-result-set" class="anchor-heading" aria-labelledby="retrieving-the-compact-result-set"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Retrieving the compact result set </h2> <p>Appending the flag <code class="language-plaintext highlighter-rouge">--compact</code> to any query issued to the GRAPH.QUERY endpoint will cause the server to issue results in the compact format. Because we don’t store connection-specific configurations, all queries should be issued with this flag.</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GRAPH.QUERY demo <span class="s2">"MATCH (a) RETURN a"</span> <span class="nt">--compact</span>
</code></pre></div></div> <h2 id="formatting-differences-in-the-compact-result-set"> <a href="#formatting-differences-in-the-compact-result-set" class="anchor-heading" aria-labelledby="formatting-differences-in-the-compact-result-set"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Formatting differences in the compact result set </h2> <p>Certain values are emitted as integer IDs rather than strings:</p> <ol> <li>Node labels</li> <li>Relationship types</li> <li>Property keys</li> </ol> <p>Instructions on how to efficiently convert these IDs in the <a href="#procedure-calls">Procedure Calls</a> section below.</p> <p>Additionally, two enums are exposed:</p> <p><a href="https://github.com/FalkorDB/FalkorDB/blob/ff108d7e21061025166a35d29be1a1cb5bac6d55/src/resultset/formatters/resultset_formatter.h#L14-L19">ColumnType</a>, which as of v2.1.0 will always be <code class="language-plaintext highlighter-rouge">COLUMN_SCALAR</code>. This enum is retained for backwards compatibility, and may be ignored by the client unless versions older than v2.1.0 must be supported.</p> <p><a href="https://github.com/FalkorDB/FalkorDB/blob/ff108d7e21061025166a35d29be1a1cb5bac6d55/src/resultset/formatters/resultset_formatter.h#L21-L28">ValueType</a> indicates the data type (such as Node, integer, or string) of each returned value. Each value is emitted as a 2-array, with this enum in the first position and the actual value in the second. Each property on a graph entity also has a scalar as its value, so this construction is nested in each value of the properties array when a column contains a node or relationship.</p> <h2 id="decoding-the-result-set"> <a href="#decoding-the-result-set" class="anchor-heading" aria-labelledby="decoding-the-result-set"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Decoding the result set </h2> <p>Given the graph created by the query:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GRAPH.QUERY demo <span class="s2">"CREATE (:plant {name: 'Tree'})-[:GROWS {season: 'Autumn'}]-&gt;(:fruit {name: 'Apple'})"</span>
</code></pre></div></div> <p>Let’s formulate a query that returns 3 columns: nodes, relationships, and scalars, in that order.</p> <p>Verbose (default):</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; GRAPH.QUERY demo <span class="s2">"MATCH (a)-[e]-&gt;(b) RETURN a, e, b.name"</span>
1<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"a"</span>
   2<span class="o">)</span> <span class="s2">"e"</span>
   3<span class="o">)</span> <span class="s2">"b.name"</span>
2<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"id"</span>
            2<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 0
         2<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"labels"</span>
            2<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"plant"</span>
         3<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"properties"</span>
            2<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"name"</span>
                  2<span class="o">)</span> <span class="s2">"Tree"</span>
      2<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"id"</span>
            2<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 0
         2<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"type"</span>
            2<span class="o">)</span> <span class="s2">"GROWS"</span>
         3<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"src_node"</span>
            2<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 0
         4<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"dest_node"</span>
            2<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 1
         5<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"properties"</span>
            2<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"season"</span>
                  2<span class="o">)</span> <span class="s2">"Autumn"</span>
      3<span class="o">)</span> <span class="s2">"Apple"</span>
3<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"Query internal execution time: 1.326905 milliseconds"</span>
</code></pre></div></div> <p>Compact:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; GRAPH.QUERY demo <span class="s2">"MATCH (a)-[e]-&gt;(b) RETURN a, e, b.name"</span> <span class="nt">--compact</span>
1<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 1
      2<span class="o">)</span> <span class="s2">"a"</span>
   2<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 1
      2<span class="o">)</span> <span class="s2">"e"</span>
   3<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 1
      2<span class="o">)</span> <span class="s2">"b.name"</span>
2<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 8
         2<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 0
            2<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 0
            3<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 0
                  2<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 2
                  3<span class="o">)</span> <span class="s2">"Tree"</span>
      2<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 7
         2<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 0
            2<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 0
            3<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 0
            4<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 1
            5<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 1
                  2<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 2
                  3<span class="o">)</span> <span class="s2">"Autumn"</span>
      3<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 2
         2<span class="o">)</span> <span class="s2">"Apple"</span>
3<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"Query internal execution time: 1.085412 milliseconds"</span>
</code></pre></div></div> <p>These results are being parsed by <code class="language-plaintext highlighter-rouge">redis-cli</code>, which adds such visual cues as array indexing and indentation, as well as type hints like <code class="language-plaintext highlighter-rouge">(integer)</code>. The actual data transmitted is formatted using the <a href="https://redis.io/topics/protocol">RESP protocol</a>. All of the current FalkorDB clients rely upon a stable Redis client in the same language (such as <a href="https://github.com/redis/redis-rb">redis-rb</a> for Ruby) which handles RESP decoding.</p> <h3 id="top-level-array-results"> <a href="#top-level-array-results" class="anchor-heading" aria-labelledby="top-level-array-results"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Top-level array results </h3> <p>The result set above had 3 members in its top-level array:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1<span class="o">)</span> Header row
2<span class="o">)</span> Result rows
3<span class="o">)</span> Query statistics
</code></pre></div></div> <p>All queries that have a <code class="language-plaintext highlighter-rouge">RETURN</code> clause will have these 3 members. Queries that don’t return results have only one member in the outermost array, the query statistics:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; GRAPH.QUERY demo <span class="s2">"CREATE (:plant {name: 'Tree'})-[:GROWS {season: 'Autumn'}]-&gt;(:fruit {name: 'Apple'})"</span> <span class="nt">--compact</span>
1<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"Labels added: 2"</span>
   2<span class="o">)</span> <span class="s2">"Nodes created: 2"</span>
   3<span class="o">)</span> <span class="s2">"Properties set: 3"</span>
   4<span class="o">)</span> <span class="s2">"Relationships created: 1"</span>
   5<span class="o">)</span> <span class="s2">"Query internal execution time: 1.972868 milliseconds"</span>
</code></pre></div></div> <p>Rather than introspecting on the query being emitted, the client implementation can check whether this array contains 1 or 3 elements to choose how to format data.</p> <h3 id="reading-the-header-row"> <a href="#reading-the-header-row" class="anchor-heading" aria-labelledby="reading-the-header-row"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Reading the header row </h3> <p>Our sample query <code class="language-plaintext highlighter-rouge">MATCH (a)-[e]-&gt;(b) RETURN a, e, b.name</code> generated the header:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 1
   2<span class="o">)</span> <span class="s2">"a"</span>
3<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 1
   3<span class="o">)</span> <span class="s2">"e"</span>
4<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 1
   3<span class="o">)</span> <span class="s2">"b.name"</span>
</code></pre></div></div> <p>The 4 array members correspond, in order, to the 3 entities described in the RETURN clause.</p> <p>Each is emitted as a 2-array:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1<span class="o">)</span> ColumnType <span class="o">(</span>enum<span class="o">)</span>
2<span class="o">)</span> column name <span class="o">(</span>string<span class="o">)</span>
</code></pre></div></div> <p>The first element is the <a href="https://github.com/FalkorDB/FalkorDB/blob/master/src/resultset/formatters/resultset_formatter.h#L14-L19">ColumnType enum</a>, which as of RedisGraph v2.1.0 will always be <code class="language-plaintext highlighter-rouge">COLUMN_SCALAR</code>. This element is retained for backwards compatibility, and may be ignored by the client unless RedisGraph versions older than v2.1.0 must be supported.</p> <h3 id="reading-result-rows"> <a href="#reading-result-rows" class="anchor-heading" aria-labelledby="reading-result-rows"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Reading result rows </h3> <p>The entity representations in this section will closely resemble those found in <a href="result_structure#graph-entities">Result Set Graph Entities</a>.</p> <p>Our query produced one row of results with 3 columns (as described by the header):</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 8
      2<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 0
         2<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 0
         3<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 0
               2<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 2
               3<span class="o">)</span> <span class="s2">"Tree"</span>
   2<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 7
      2<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 0
         2<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 0
         3<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 0
         4<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 1
         5<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 1
               2<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 2
               3<span class="o">)</span> <span class="s2">"Autumn"</span>
   3<span class="o">)</span> 1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> 2
      2<span class="o">)</span> <span class="s2">"Apple"</span>
</code></pre></div></div> <p>Each element is emitted as a 2-array - [<code class="language-plaintext highlighter-rouge">ValueType</code>, value].</p> <p>It is the client’s responsibility to store the <a href="https://github.com/FalkorDB/FalkorDB/blob/master/src/resultset/formatters/resultset_formatter.h#L21-L28">ValueType enum</a>. FalkorDB guarantees that this enum may be extended in the future, but the existing values will not be altered.</p> <p>The <code class="language-plaintext highlighter-rouge">ValueType</code> for the first entry is <code class="language-plaintext highlighter-rouge">VALUE_NODE</code>. The node representation contains 3 top-level elements:</p> <ol> <li>The node’s internal ID.</li> <li>An array of all label IDs associated with the node (currently, each node can have either 0 or 1 labels, though this restriction may be lifted in the future).</li> <li>An array of all properties the node contains. Properties are represented as 3-arrays - [property key ID, <code class="language-plaintext highlighter-rouge">ValueType</code>, value].</li> </ol> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>	
    Node ID <span class="o">(</span>integer<span class="o">)</span>,
    <span class="o">[</span>label ID <span class="o">(</span>integer<span class="o">)</span> X label count]
    <span class="o">[[</span>property key ID <span class="o">(</span>integer<span class="o">)</span>, ValueType <span class="o">(</span>enum<span class="o">)</span>, value <span class="o">(</span>scalar<span class="o">)]</span> X property count]
<span class="o">]</span>
</code></pre></div></div> <p>The <code class="language-plaintext highlighter-rouge">ValueType</code> for the first entry is <code class="language-plaintext highlighter-rouge">VALUE_EDGE</code>. The edge representation differs from the node representation in two respects:</p> <ul> <li>Each relation has exactly one type, rather than the 0+ labels a node may have.</li> <li>A relation is emitted with the IDs of its source and destination nodes.</li> </ul> <p>As such, the complete representation is as follows:</p> <ol> <li>The relation’s internal ID.</li> <li>The relationship type ID.</li> <li>The source node’s internal ID.</li> <li>The destination node’s internal ID.</li> <li>The key-value pairs of all properties the relation possesses.</li> </ol> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>	
    Relation ID <span class="o">(</span>integer<span class="o">)</span>,
    <span class="nb">type </span>ID <span class="o">(</span>integer<span class="o">)</span>,
    <span class="nb">source </span>node ID <span class="o">(</span>integer<span class="o">)</span>,
    destination node ID <span class="o">(</span>integer<span class="o">)</span>,
    <span class="o">[[</span>property key ID <span class="o">(</span>integer<span class="o">)</span>, ValueType <span class="o">(</span>enum<span class="o">)</span>, value <span class="o">(</span>scalar<span class="o">)]</span> X property count]
<span class="o">]</span>
</code></pre></div></div> <p>The <code class="language-plaintext highlighter-rouge">ValueType</code> for the third entry is <code class="language-plaintext highlighter-rouge">VALUE_STRING</code>, and the other element in the array is the actual value, “Apple”.</p> <h3 id="reading-statistics"> <a href="#reading-statistics" class="anchor-heading" aria-labelledby="reading-statistics"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Reading statistics </h3> <p>The final top-level member of the GRAPH.QUERY reply is the execution statistics. This element is identical between the compact and standard response formats.</p> <p>The statistics always include query execution time, while any combination of the other elements may be included depending on how the graph was modified.</p> <ol> <li>“Labels added: (integer)”</li> <li>“Labels removed: (integer)” (since RedisGraph 2.10)</li> <li>“Nodes created: (integer)”</li> <li>“Nodes deleted: (integer)”</li> <li>“Properties set: (integer)”</li> <li>“Properties removed: (integer)” (since RedisGraph 2.10)</li> <li>“Relationships created: (integer)”</li> <li>“Relationships deleted: (integer)”</li> <li>“Indices created: (integer)”</li> <li>“Indices deleted: (integer)”</li> <li>“Query internal execution time: (float) milliseconds”</li> </ol> <h2 id="procedure-calls"> <a href="#procedure-calls" class="anchor-heading" aria-labelledby="procedure-calls"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Procedure Calls </h2> <p>Property keys, node labels, and relationship types are all returned as IDs rather than strings in the compact format. For each of these 3 string-ID mappings, IDs start at 0 and increase monotonically.</p> <p>As such, the client should store a string array for each of these 3 mappings, and print the appropriate string for the user by checking an array at position <em>ID</em>. If an ID greater than the array length is encountered, the local array should be updated with a procedure call.</p> <p>These calls are described generally in the <a href="/commands/graph.query#procedures">Procedures documentation</a>.</p> <p>To retrieve each full mapping, the appropriate calls are:</p> <p><code class="language-plaintext highlighter-rouge">db.labels()</code></p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; GRAPH.QUERY demo <span class="s2">"CALL db.labels()"</span>
1<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"label"</span>
2<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"plant"</span>
   2<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"fruit"</span>
3<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"Query internal execution time: 0.321513 milliseconds"</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">db.relationshipTypes()</code></p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; GRAPH.QUERY demo <span class="s2">"CALL db.relationshipTypes()"</span>
1<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"relationshipType"</span>
2<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"GROWS"</span>
3<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"Query internal execution time: 0.429677 milliseconds"</span>
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">db.propertyKeys()</code></p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>127.0.0.1:6379&gt; GRAPH.QUERY demo <span class="s2">"CALL db.propertyKeys()"</span>
1<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"propertyKey"</span>
2<span class="o">)</span> 1<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"name"</span>
   2<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"season"</span>
3<span class="o">)</span> 1<span class="o">)</span> <span class="s2">"Query internal execution time: 0.318940 milliseconds"</span>
</code></pre></div></div> <p>Because the cached values never become outdated, it is possible to just retrieve new values with slightly more complex constructions:</p> <div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CALL db.propertyKeys<span class="o">()</span> YIELD propertyKey RETURN propertyKey SKIP <span class="o">[</span>cached_array_length]
</code></pre></div></div> <p>Though the property calls are quite efficient regardless of whether this optimization is used.</p> <p>As an example, the Python client checks its local array of labels to resolve every label ID <a href="https://github.com/RedisGraph/redisgraph-py/blob/d65ec325b1909489845427b7100dcba6c4050b66/redisgraph/graph.py#L20-L32">as seen here</a>.</p> <p>In the case of an IndexError, it issues a procedure call to fully refresh its label cache <a href="https://github.com/RedisGraph/redisgraph-py/blob/d65ec325b1909489845427b7100dcba6c4050b66/redisgraph/graph.py#L153-L154">as seen here</a>.</p> <h2 id="reference-clients"> <a href="#reference-clients" class="anchor-heading" aria-labelledby="reference-clients"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Reference clients </h2> <p>All the logic described in this document has been implemented in most of the clients listed in <a href="clients">Client Libraries</a>. Among these, <code class="language-plaintext highlighter-rouge">node-redis</code>, <code class="language-plaintext highlighter-rouge">redis-py</code> and <code class="language-plaintext highlighter-rouge">jedis</code> are currently the most sophisticated.</p> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
